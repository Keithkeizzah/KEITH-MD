(()=>{"use strict";var t={};t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}();class s{static mathOperations(t,s,i){switch(i){case"+":return s+t;case"-":return s-t;case"*":return s*t;case"/":return s/t;case"%":return s%t;case"^":return Math.pow(s,t);default:return 0}}}s.availableOperators="+-*/%^";class i{constructor(t){this.in=t,this.out=null}getOutput(){return null==this.out?this.convert():this.out}}class e extends i{constructor(t,s){super(t),this.exprs=[],this.regex=/(?<input>(?<fun>[A-Za-z]+)\s{0,}\((?<params>[0-9\.\s\+\-,\*\/\%\^]+)\))/g,this.funcs=null==s?{}:s}prepare(){let t;for(;null!==(t=this.regex.exec(this.in));)if("function"==typeof this.funcs[t.groups.fun])this.exprs.push({input:t.groups.input,output:this.funcs[t.groups.fun](...t.groups.params.split(",").map((t=>parseFloat(t))))});else{if("function"!=typeof Math[t.groups.fun])throw new Error(`Method ${t.groups.fun} not found `);this.exprs.push({input:t.groups.input,output:Math[t.groups.fun](...t.groups.params.split(",").map((t=>parseFloat(t))))})}}convert(){null==this.out&&this.prepare(),this.out=this.in;for(let t=0;t<this.exprs.length;t++)this.out=this.out.replace(this.exprs[t].input,this.exprs[t].output);return this.out=this.out.replace(/[A-Za-z]*/g,""),this.out}}class r{constructor(t){this.data=t,this.next=this.previous=null}display(){console.log(this.data)}}class n{constructor(t){this.len=0,null==t?this.first=this.last=null:this.entryPoint(t)}entryPoint(t){this.last=this.first=new r(t),this.len++}isEmpty(){return null==this.first&&null==this.last||this.len<=0}insertFirst(t){if(this.isEmpty())this.entryPoint(t);else{let s=this.first;this.first=new r(t),this.first.next=s,s.previous=this.first,this.len++}return 0}insertLast(t){if(this.isEmpty)this.entryPoint(t);else{let s=this.last;this.last=new r(t),this.last.previous=s,s.next=this.last,this.len++}return 0}removeFirst(){if(this.isEmpty())return null;let t=this.first;return null==t.next?this.first=this.last=null:this.first=t.next,this.len--,t.data}removeLast(){if(this.isEmpty())return null;let t=this.last;return null==t.previous?(this.last=t.previous,null!=this.last.next&&(this.last.next=null)):this.first=this.last=null,this.len--,t.data}getFirst(){return null==this.first?null:this.first.data}getLast(){return null==this.last?null:this.last.data}length(){return this.len}display(){let t=this.first;for(;null!=t;)t.display(),t=t.next}}class u{constructor(){this.list=new n}push(t){this.list.insertFirst(t)}pop(){if(this.isEmpty())throw new Error("Stack Is Empty");return this.list.removeFirst()}peek(){if(this.isEmpty())throw new Error("Stack Is Empty");return this.list.getFirst()}isEmpty(){return this.list.isEmpty()}size(){return this.list.length()}display(){this.list.display()}}class l{static isDigit(t){return!isNaN(parseFloat(t))}static isDot(t){return"."===t}static isSpace(t){return" "===t}static isOpenBracket(t){return"("===t}static isClosedBracket(t){return")"===t}static isMiuns(t,s){return"-"===t&&l.isDigit(s)}static mathOperatorPriority(t){switch(t){case"+":case"-":return 1;case"*":case"/":case"%":return 2;case"^":return 3;default:return 0}}}class a extends i{constructor(t){super(t)}convert(){if(null!=this.out)return this.out;let t=new u;this.out="";let i="",e=-1;for(let r=0;r<this.in.length;r++){if(i=this.in.charAt(r),l.isMiuns(i,this.in.charAt(r+1))&&r!=e){let t=this.in.slice(0,r).trim();t.length>0&&l.isDigit(t.charAt(t.length-1))&&(i="+",e=r,--r)}if(l.isDigit(i)||l.isDot(i)||l.isSpace(i)||l.isMiuns(i,this.in.charAt(r+1)))this.out+=i;else if(l.isOpenBracket(i))t.push(i);else if(l.isClosedBracket(i)){for(;!t.isEmpty()&&!l.isOpenBracket(t.peek());)this.out+=" "+t.pop();t.pop()}else if(-1==s.availableOperators.indexOf(i))this.out+="0";else{for(this.out+=" ";!t.isEmpty()&&l.mathOperatorPriority(i)<=l.mathOperatorPriority(t.peek());)this.out+=t.pop()+" ";t.push(i)}}for(;!t.isEmpty();)this.out+=" "+t.pop()+" ";return this.out}evaluate(){null==this.out&&this.convert();let t=new u;for(let i of this.out.trim().split(" "))""!=i&&(l.isDigit(i)?t.push(i):t.push(s.mathOperations(t.isEmpty()?0:parseFloat(t.pop()),t.isEmpty()?0:parseFloat(t.pop()),i).toString()));return t.isEmpty()||isNaN(parseFloat(t.peek()))?0:parseFloat(t.pop())}}class h{static execute(t){return new a(new e(t,h.fucs).convert()).evaluate()}static setFucs(t){h.fucs=t}}h.fucs={},"undefined"==typeof window?t.g.Calculator=h:window.Calculator=h})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEtBQUsyQyxJQUl2QixNQUFRRCxFQUFNbkIsV0FDVnRELEtBQUtnQixLQUFPLElBQU15RCxFQUFNUixNQUFRLElBRXBDLE9BQU9qRSxLQUFLZ0IsSUFFaEJ1RSxXQUNvQixNQUFadkYsS0FBS2dCLEtBQ0xoQixLQUFLa0IsVUFFVCxJQUFJdUQsRUFBUSxJQUFJWCxFQUNoQixJQUFLLElBQUkwQixLQUFXeEYsS0FBS2dCLElBQUlnRSxPQUFPN0MsTUFBTSxLQUN2QixJQUFYcUQsSUFHQXBCLEVBQU9HLFFBQVFpQixHQUNmZixFQUFNMUMsS0FBS3lELEdBR1hmLEVBQU0xQyxLQUFLM0IsRUFBVXFGLGVBQWVoQixFQUFNbkIsVUFBWSxFQUFJaEIsV0FBV21DLEVBQU1SLE9BQVFRLEVBQU1uQixVQUFZLEVBQUloQixXQUFXbUMsRUFBTVIsT0FBUXVCLEdBQVNFLGFBR25KLE9BQVVqQixFQUFNbkIsV0FBZ0JlLE1BQU0vQixXQUFXbUMsRUFBTVAsU0FBdUMsRUFBMUI1QixXQUFXbUMsRUFBTVIsUUNyRXRGLE1BQU0wQixFQUNUdEYsZUFBZVMsR0FFWCxPQURvQixJQUFJMEQsRUFBZ0IsSUFBSXJELEVBQWFMLEVBQVk2RSxFQUFXQyxNQUFNMUUsV0FDakVxRSxXQUV6QmxGLGVBQWV1RixHQUNYRCxFQUFXQyxLQUFPQSxHQUcxQkQsRUFBV0MsS0FBTyxHQ1ZJLG9CQUFYekYsT0FDUCxFQUFBTCxFQUFPNkYsV0FBYUEsRUFHcEJ4RixPQUFPd0YsV0FBYUEsRyIsInNvdXJjZXMiOlsid2VicGFjazovL2NhbGN1bGF0b3ItZW5naW5lL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL2NhbGN1bGF0b3ItZW5naW5lL3dlYnBhY2svcnVudGltZS9nbG9iYWwiLCJ3ZWJwYWNrOi8vY2FsY3VsYXRvci1lbmdpbmUvLi9zcmMvY29udmVydGVycy9Db3ZlcnRlci50cyIsIndlYnBhY2s6Ly9jYWxjdWxhdG9yLWVuZ2luZS8uL3NyYy9jb252ZXJ0ZXJzL0Z1bkNvbnZlcnRlci50cyIsIndlYnBhY2s6Ly9jYWxjdWxhdG9yLWVuZ2luZS8uL3NyYy9zdGFjay9saW5rZWRsaXN0L0xpbmsudHMiLCJ3ZWJwYWNrOi8vY2FsY3VsYXRvci1lbmdpbmUvLi9zcmMvc3RhY2svbGlua2VkbGlzdC9MaXN0LnRzIiwid2VicGFjazovL2NhbGN1bGF0b3ItZW5naW5lLy4vc3JjL3N0YWNrL1N0YWNrLnRzIiwid2VicGFjazovL2NhbGN1bGF0b3ItZW5naW5lLy4vc3JjL2NvbnZlcnRlcnMvaGVscHJ0LnRzIiwid2VicGFjazovL2NhbGN1bGF0b3ItZW5naW5lLy4vc3JjL2NvbnZlcnRlcnMvSVBvc3RDb252ZXJ0ZXIudHMiLCJ3ZWJwYWNrOi8vY2FsY3VsYXRvci1lbmdpbmUvLi9zcmMvQ2FsY3VsYXRvci50cyIsIndlYnBhY2s6Ly9jYWxjdWxhdG9yLWVuZ2luZS8uL3NyYy9idWlsZC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBUaGUgcmVxdWlyZSBzY29wZVxudmFyIF9fd2VicGFja19yZXF1aXJlX18gPSB7fTtcblxuIiwiX193ZWJwYWNrX3JlcXVpcmVfXy5nID0gKGZ1bmN0aW9uKCkge1xuXHRpZiAodHlwZW9mIGdsb2JhbFRoaXMgPT09ICdvYmplY3QnKSByZXR1cm4gZ2xvYmFsVGhpcztcblx0dHJ5IHtcblx0XHRyZXR1cm4gdGhpcyB8fCBuZXcgRnVuY3Rpb24oJ3JldHVybiB0aGlzJykoKTtcblx0fSBjYXRjaCAoZSkge1xuXHRcdGlmICh0eXBlb2Ygd2luZG93ID09PSAnb2JqZWN0JykgcmV0dXJuIHdpbmRvdztcblx0fVxufSkoKTsiLCJjbGFzcyBFdmFsdWF0b3Ige1xuICAgIHN0YXRpYyBtYXRoT3BlcmF0aW9ucyhzZWNvbmQsIGZpcnN0LCBvcGVyYXRpb24pIHtcbiAgICAgICAgc3dpdGNoIChvcGVyYXRpb24pIHtcbiAgICAgICAgICAgIGNhc2UgXCIrXCI6IHJldHVybiBmaXJzdCArIHNlY29uZDtcbiAgICAgICAgICAgIGNhc2UgXCItXCI6IHJldHVybiBmaXJzdCAtIHNlY29uZDtcbiAgICAgICAgICAgIGNhc2UgXCIqXCI6IHJldHVybiBmaXJzdCAqIHNlY29uZDtcbiAgICAgICAgICAgIGNhc2UgXCIvXCI6IHJldHVybiBmaXJzdCAvIHNlY29uZDtcbiAgICAgICAgICAgIGNhc2UgXCIlXCI6IHJldHVybiBmaXJzdCAlIHNlY29uZDtcbiAgICAgICAgICAgIGNhc2UgJ14nOiByZXR1cm4gTWF0aC5wb3coZmlyc3QsIHNlY29uZCk7XG4gICAgICAgICAgICBkZWZhdWx0OiByZXR1cm4gMC4wO1xuICAgICAgICB9XG4gICAgfVxufVxuRXZhbHVhdG9yLmF2YWlsYWJsZU9wZXJhdG9ycyA9IFwiKy0qLyVeXCI7XG5jbGFzcyBDb252ZXJ0ZXIge1xuICAgIGNvbnN0cnVjdG9yKGV4cHJlc3Npb24pIHtcbiAgICAgICAgdGhpcy5pbiA9IGV4cHJlc3Npb247XG4gICAgICAgIHRoaXMub3V0ID0gbnVsbDtcbiAgICB9XG4gICAgZ2V0T3V0cHV0KCkge1xuICAgICAgICBpZiAodGhpcy5vdXQgPT0gbnVsbCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29udmVydCgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLm91dDtcbiAgICB9XG59XG5leHBvcnQgeyBDb252ZXJ0ZXIsIEV2YWx1YXRvciB9O1xuO1xuIiwiaW1wb3J0IHsgQ29udmVydGVyIH0gZnJvbSBcIi4vQ292ZXJ0ZXJcIjtcbmV4cG9ydCBjbGFzcyBGdW5Db252ZXJ0ZXIgZXh0ZW5kcyBDb252ZXJ0ZXIge1xuICAgIGNvbnN0cnVjdG9yKGV4cHJlc3Npb24sIGZ1bmMpIHtcbiAgICAgICAgc3VwZXIoZXhwcmVzc2lvbik7XG4gICAgICAgIHRoaXMuZXhwcnMgPSBbXTtcbiAgICAgICAgdGhpcy5yZWdleCA9IC8oPzxpbnB1dD4oPzxmdW4+W0EtWmEtel0rKVxcc3swLH1cXCgoPzxwYXJhbXM+WzAtOVxcLlxcc1xcK1xcLSxcXCpcXC9cXCVcXF5dKylcXCkpL2c7XG4gICAgICAgIGlmIChmdW5jID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5mdW5jcyA9IHt9O1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5mdW5jcyA9IGZ1bmM7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcHJlcGFyZSgpIHtcbiAgICAgICAgbGV0IGV4cDtcbiAgICAgICAgd2hpbGUgKChleHAgPSB0aGlzLnJlZ2V4LmV4ZWModGhpcy5pbikpICE9PSBudWxsKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHRoaXMuZnVuY3NbZXhwLmdyb3Vwcy5mdW5dID09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmV4cHJzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICBpbnB1dDogZXhwLmdyb3Vwcy5pbnB1dCxcbiAgICAgICAgICAgICAgICAgICAgb3V0cHV0OiB0aGlzLmZ1bmNzW2V4cC5ncm91cHMuZnVuXSguLi5leHAuZ3JvdXBzLnBhcmFtcy5zcGxpdChcIixcIikubWFwKChfKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGFyc2VGbG9hdChfKTtcbiAgICAgICAgICAgICAgICAgICAgfSkpXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0eXBlb2YgTWF0aFtleHAuZ3JvdXBzLmZ1bl0gPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgIHRoaXMuZXhwcnMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIGlucHV0OiBleHAuZ3JvdXBzLmlucHV0LFxuICAgICAgICAgICAgICAgICAgICBvdXRwdXQ6IE1hdGhbZXhwLmdyb3Vwcy5mdW5dKC4uLmV4cC5ncm91cHMucGFyYW1zLnNwbGl0KFwiLFwiKS5tYXAoKF8pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwYXJzZUZsb2F0KF8pO1xuICAgICAgICAgICAgICAgICAgICB9KSlcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgTWV0aG9kICR7ZXhwLmdyb3Vwcy5mdW59IG5vdCBmb3VuZCBgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBjb252ZXJ0KCkge1xuICAgICAgICBpZiAodGhpcy5vdXQgPT0gbnVsbCkge1xuICAgICAgICAgICAgdGhpcy5wcmVwYXJlKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5vdXQgPSB0aGlzLmluO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuZXhwcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHRoaXMub3V0ID0gdGhpcy5vdXQucmVwbGFjZSh0aGlzLmV4cHJzW2ldLmlucHV0LCB0aGlzLmV4cHJzW2ldLm91dHB1dCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5vdXQgPSB0aGlzLm91dC5yZXBsYWNlKC9bQS1aYS16XSovZywgJycpO1xuICAgICAgICByZXR1cm4gdGhpcy5vdXQ7XG4gICAgfVxufVxuIiwiZXhwb3J0IGNsYXNzIExpbmsge1xuICAgIGNvbnN0cnVjdG9yKGRhdGEpIHtcbiAgICAgICAgdGhpcy5kYXRhID0gZGF0YTtcbiAgICAgICAgdGhpcy5uZXh0ID0gdGhpcy5wcmV2aW91cyA9IG51bGw7XG4gICAgfVxuICAgIGRpc3BsYXkoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKHRoaXMuZGF0YSk7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgTGluayB9IGZyb20gXCIuL0xpbmtcIjtcbmV4cG9ydCBjbGFzcyBMaXN0IHtcbiAgICBjb25zdHJ1Y3RvcihkYXRhKSB7XG4gICAgICAgIHRoaXMubGVuID0gMDtcbiAgICAgICAgaWYgKGRhdGEgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aGlzLmZpcnN0ID0gdGhpcy5sYXN0ID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuZW50cnlQb2ludChkYXRhKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbnRyeVBvaW50KGRhdGEpIHtcbiAgICAgICAgdGhpcy5sYXN0ID0gdGhpcy5maXJzdCA9IG5ldyBMaW5rKGRhdGEpO1xuICAgICAgICB0aGlzLmxlbisrO1xuICAgIH1cbiAgICBpc0VtcHR5KCkge1xuICAgICAgICByZXR1cm4gKCgodGhpcy5maXJzdCA9PSBudWxsKSAmJiAodGhpcy5sYXN0ID09IG51bGwpKSB8fCAodGhpcy5sZW4gPD0gMCkpO1xuICAgIH1cbiAgICBpbnNlcnRGaXJzdChkYXRhKSB7XG4gICAgICAgIGlmICh0aGlzLmlzRW1wdHkoKSkge1xuICAgICAgICAgICAgdGhpcy5lbnRyeVBvaW50KGRhdGEpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbGV0IHRtcCA9IHRoaXMuZmlyc3Q7XG4gICAgICAgICAgICB0aGlzLmZpcnN0ID0gbmV3IExpbmsoZGF0YSk7XG4gICAgICAgICAgICB0aGlzLmZpcnN0Lm5leHQgPSB0bXA7XG4gICAgICAgICAgICB0bXAucHJldmlvdXMgPSB0aGlzLmZpcnN0O1xuICAgICAgICAgICAgdGhpcy5sZW4rKztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gMDtcbiAgICB9XG4gICAgaW5zZXJ0TGFzdChkYXRhKSB7XG4gICAgICAgIGlmICh0aGlzLmlzRW1wdHkpXG4gICAgICAgICAgICB0aGlzLmVudHJ5UG9pbnQoZGF0YSk7XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbGV0IHRtcCA9IHRoaXMubGFzdDtcbiAgICAgICAgICAgIHRoaXMubGFzdCA9IG5ldyBMaW5rKGRhdGEpO1xuICAgICAgICAgICAgdGhpcy5sYXN0LnByZXZpb3VzID0gdG1wO1xuICAgICAgICAgICAgdG1wLm5leHQgPSB0aGlzLmxhc3Q7XG4gICAgICAgICAgICB0aGlzLmxlbisrO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgICByZW1vdmVGaXJzdCgpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNFbXB0eSgpKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBsZXQgdG1wID0gdGhpcy5maXJzdDtcbiAgICAgICAgaWYgKHRtcC5uZXh0ID09IG51bGwpIHtcbiAgICAgICAgICAgIHRoaXMuZmlyc3QgPSB0aGlzLmxhc3QgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5maXJzdCA9IHRtcC5uZXh0O1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubGVuLS07XG4gICAgICAgIHJldHVybiB0bXAuZGF0YTtcbiAgICB9XG4gICAgcmVtb3ZlTGFzdCgpIHtcbiAgICAgICAgaWYgKCh0aGlzLmlzRW1wdHkoKSkpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGxldCB0bXAgPSB0aGlzLmxhc3Q7XG4gICAgICAgIGlmICh0bXAucHJldmlvdXMgPT0gbnVsbCkge1xuICAgICAgICAgICAgdGhpcy5sYXN0ID0gdG1wLnByZXZpb3VzO1xuICAgICAgICAgICAgdGhpcy5sYXN0Lm5leHQgIT0gbnVsbCA/IHRoaXMubGFzdC5uZXh0ID0gbnVsbCA6IFwiXCI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmZpcnN0ID0gdGhpcy5sYXN0ID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmxlbi0tO1xuICAgICAgICByZXR1cm4gdG1wLmRhdGE7XG4gICAgfVxuICAgIGdldEZpcnN0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5maXJzdCA9PSBudWxsID8gbnVsbCA6IHRoaXMuZmlyc3QuZGF0YTtcbiAgICB9XG4gICAgZ2V0TGFzdCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubGFzdCA9PSBudWxsID8gbnVsbCA6IHRoaXMubGFzdC5kYXRhO1xuICAgIH1cbiAgICBsZW5ndGgoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmxlbjtcbiAgICB9XG4gICAgZGlzcGxheSgpIHtcbiAgICAgICAgbGV0IHRtcCA9IHRoaXMuZmlyc3Q7XG4gICAgICAgIHdoaWxlICh0bXAgIT0gbnVsbCkge1xuICAgICAgICAgICAgdG1wLmRpc3BsYXkoKTtcbiAgICAgICAgICAgIHRtcCA9IHRtcC5uZXh0O1xuICAgICAgICB9XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgTGlzdCB9IGZyb20gJy4vbGlua2VkbGlzdC9MaXN0JztcbmV4cG9ydCBjbGFzcyBTdGFjayB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMubGlzdCA9IG5ldyBMaXN0KCk7XG4gICAgfVxuICAgIHB1c2godmFsdWUpIHtcbiAgICAgICAgdGhpcy5saXN0Lmluc2VydEZpcnN0KHZhbHVlKTtcbiAgICB9XG4gICAgcG9wKCkge1xuICAgICAgICBpZiAodGhpcy5pc0VtcHR5KCkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlN0YWNrIElzIEVtcHR5XCIpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLmxpc3QucmVtb3ZlRmlyc3QoKTtcbiAgICB9XG4gICAgcGVlaygpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNFbXB0eSgpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJTdGFjayBJcyBFbXB0eVwiKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5saXN0LmdldEZpcnN0KCk7XG4gICAgfVxuICAgIGlzRW1wdHkoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmxpc3QuaXNFbXB0eSgpO1xuICAgIH1cbiAgICBzaXplKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5saXN0Lmxlbmd0aCgpO1xuICAgIH1cbiAgICBkaXNwbGF5KCkge1xuICAgICAgICB0aGlzLmxpc3QuZGlzcGxheSgpO1xuICAgIH1cbn1cbiIsImV4cG9ydCBjbGFzcyBIZWxwZXIge1xuICAgIHN0YXRpYyBpc0RpZ2l0KHZhbHVlKSB7XG4gICAgICAgIGlmIChpc05hTihwYXJzZUZsb2F0KHZhbHVlKSkpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgc3RhdGljIGlzRG90KHZhbHVlKSB7XG4gICAgICAgIHJldHVybiBcIi5cIiA9PT0gdmFsdWU7XG4gICAgfVxuICAgIHN0YXRpYyBpc1NwYWNlKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiBcIiBcIiA9PT0gdmFsdWU7XG4gICAgfVxuICAgIHN0YXRpYyBpc09wZW5CcmFja2V0KHZhbHVlKSB7XG4gICAgICAgIHJldHVybiBcIihcIiA9PT0gdmFsdWU7XG4gICAgfVxuICAgIHN0YXRpYyBpc0Nsb3NlZEJyYWNrZXQodmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIFwiKVwiID09PSB2YWx1ZTtcbiAgICB9XG4gICAgc3RhdGljIGlzTWl1bnModmFsdWUsIG5leHRWYWx1ZSkge1xuICAgICAgICByZXR1cm4gKChcIi1cIiA9PT0gdmFsdWUpICYmIChIZWxwZXIuaXNEaWdpdChuZXh0VmFsdWUpKSk7XG4gICAgfVxuICAgIHN0YXRpYyBtYXRoT3BlcmF0b3JQcmlvcml0eSh2YWx1ZSkge1xuICAgICAgICBzd2l0Y2ggKHZhbHVlKSB7XG4gICAgICAgICAgICBjYXNlICcrJzpcbiAgICAgICAgICAgIGNhc2UgJy0nOlxuICAgICAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICAgICAgY2FzZSAnKic6XG4gICAgICAgICAgICBjYXNlICcvJzpcbiAgICAgICAgICAgIGNhc2UgJyUnOlxuICAgICAgICAgICAgICAgIHJldHVybiAyO1xuICAgICAgICAgICAgY2FzZSAnXic6XG4gICAgICAgICAgICAgICAgcmV0dXJuIDM7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgQ29udmVydGVyLCBFdmFsdWF0b3IgfSBmcm9tIFwiLi9Db3ZlcnRlclwiO1xuaW1wb3J0IHsgU3RhY2sgfSBmcm9tIFwiLi4vc3RhY2svU3RhY2tcIjtcbmltcG9ydCB7IEhlbHBlciB9IGZyb20gXCIuL2hlbHBydFwiO1xuZXhwb3J0IGNsYXNzIElQb3N0Q29udmVydGVyIGV4dGVuZHMgQ29udmVydGVyIHtcbiAgICBjb25zdHJ1Y3RvcihleHByZXNzaW9uKSB7XG4gICAgICAgIHN1cGVyKGV4cHJlc3Npb24pO1xuICAgIH1cbiAgICBjb252ZXJ0KCkge1xuICAgICAgICBpZiAodGhpcy5vdXQgIT0gbnVsbCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMub3V0O1xuICAgICAgICB9XG4gICAgICAgIGxldCBzdGFjayA9IG5ldyBTdGFjaygpO1xuICAgICAgICB0aGlzLm91dCA9IFwiXCI7XG4gICAgICAgIGxldCBjaGFyID0gJyc7XG4gICAgICAgIGxldCBwb3NpdGlvbiA9IC0xO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuaW4ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGNoYXIgPSB0aGlzLmluLmNoYXJBdChpKTtcbiAgICAgICAgICAgIGlmICgoSGVscGVyLmlzTWl1bnMoY2hhciwgdGhpcy5pbi5jaGFyQXQoaSArIDEpKSkgJiYgKGkgIT0gcG9zaXRpb24pKSB7XG4gICAgICAgICAgICAgICAgbGV0IG5ld0lwdXQgPSB0aGlzLmluLnNsaWNlKDAsIGkpLnRyaW0oKTtcbiAgICAgICAgICAgICAgICBpZiAoKG5ld0lwdXQubGVuZ3RoID4gMCkgJiYgKEhlbHBlci5pc0RpZ2l0KG5ld0lwdXQuY2hhckF0KG5ld0lwdXQubGVuZ3RoIC0gMSkpKSkge1xuICAgICAgICAgICAgICAgICAgICBjaGFyID0gJysnO1xuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbiA9IGk7XG4gICAgICAgICAgICAgICAgICAgIC0taTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoSGVscGVyLmlzRGlnaXQoY2hhcikgfHwgSGVscGVyLmlzRG90KGNoYXIpIHx8IEhlbHBlci5pc1NwYWNlKGNoYXIpIHx8IEhlbHBlci5pc01pdW5zKGNoYXIsIHRoaXMuaW4uY2hhckF0KGkgKyAxKSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm91dCArPSBjaGFyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoSGVscGVyLmlzT3BlbkJyYWNrZXQoY2hhcikpIHtcbiAgICAgICAgICAgICAgICBzdGFjay5wdXNoKGNoYXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoSGVscGVyLmlzQ2xvc2VkQnJhY2tldChjaGFyKSkge1xuICAgICAgICAgICAgICAgIHdoaWxlICgoIXN0YWNrLmlzRW1wdHkoKSkgJiYgKCFIZWxwZXIuaXNPcGVuQnJhY2tldChzdGFjay5wZWVrKCkpKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm91dCArPSBcIiBcIiArIHN0YWNrLnBvcCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzdGFjay5wb3AoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChFdmFsdWF0b3IuYXZhaWxhYmxlT3BlcmF0b3JzLmluZGV4T2YoY2hhcikgPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vdXQgKz0gXCIwXCI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm91dCArPSBcIiBcIjtcbiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKCghc3RhY2suaXNFbXB0eSgpKSAmJiAoSGVscGVyLm1hdGhPcGVyYXRvclByaW9yaXR5KGNoYXIpIDw9IEhlbHBlci5tYXRoT3BlcmF0b3JQcmlvcml0eShzdGFjay5wZWVrKCkpKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vdXQgKz0gc3RhY2sucG9wKCkgKyBcIiBcIjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBzdGFjay5wdXNoKGNoYXIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB3aGlsZSAoIXN0YWNrLmlzRW1wdHkoKSkge1xuICAgICAgICAgICAgdGhpcy5vdXQgKz0gXCIgXCIgKyBzdGFjay5wb3AoKSArIFwiIFwiO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLm91dDtcbiAgICB9XG4gICAgZXZhbHVhdGUoKSB7XG4gICAgICAgIGlmICh0aGlzLm91dCA9PSBudWxsKSB7XG4gICAgICAgICAgICB0aGlzLmNvbnZlcnQoKTtcbiAgICAgICAgfVxuICAgICAgICBsZXQgc3RhY2sgPSBuZXcgU3RhY2soKTtcbiAgICAgICAgZm9yIChsZXQgY3VycmVudCBvZiB0aGlzLm91dC50cmltKCkuc3BsaXQoXCIgXCIpKSB7XG4gICAgICAgICAgICBpZiAoY3VycmVudCA9PSAnJykge1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKEhlbHBlci5pc0RpZ2l0KGN1cnJlbnQpKSB7XG4gICAgICAgICAgICAgICAgc3RhY2sucHVzaChjdXJyZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHN0YWNrLnB1c2goRXZhbHVhdG9yLm1hdGhPcGVyYXRpb25zKHN0YWNrLmlzRW1wdHkoKSA/IDAgOiBwYXJzZUZsb2F0KHN0YWNrLnBvcCgpKSwgc3RhY2suaXNFbXB0eSgpID8gMCA6IHBhcnNlRmxvYXQoc3RhY2sucG9wKCkpLCBjdXJyZW50KS50b1N0cmluZygpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKCghc3RhY2suaXNFbXB0eSgpKSAmJiAoIWlzTmFOKHBhcnNlRmxvYXQoc3RhY2sucGVlaygpKSkpKSA/IHBhcnNlRmxvYXQoc3RhY2sucG9wKCkpIDogMDtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBGdW5Db252ZXJ0ZXIgfSBmcm9tIFwiLi9jb252ZXJ0ZXJzL0Z1bkNvbnZlcnRlclwiO1xuaW1wb3J0IHsgSVBvc3RDb252ZXJ0ZXIgfSBmcm9tIFwiLi9jb252ZXJ0ZXJzL0lQb3N0Q29udmVydGVyXCI7XG5leHBvcnQgY2xhc3MgQ2FsY3VsYXRvciB7XG4gICAgc3RhdGljIGV4ZWN1dGUoZXhwcmVzc2lvbikge1xuICAgICAgICBsZXQgcG9zdENvbnZlcnRlciA9IG5ldyBJUG9zdENvbnZlcnRlcigobmV3IEZ1bkNvbnZlcnRlcihleHByZXNzaW9uLCBDYWxjdWxhdG9yLmZ1Y3MpLmNvbnZlcnQoKSkpO1xuICAgICAgICByZXR1cm4gcG9zdENvbnZlcnRlci5ldmFsdWF0ZSgpO1xuICAgIH1cbiAgICBzdGF0aWMgc2V0RnVjcyhmdWNzKSB7XG4gICAgICAgIENhbGN1bGF0b3IuZnVjcyA9IGZ1Y3M7XG4gICAgfVxufVxuQ2FsY3VsYXRvci5mdWNzID0ge307XG4iLCJpbXBvcnQgeyBDYWxjdWxhdG9yIH0gZnJvbSBcIi4vQ2FsY3VsYXRvclwiO1xuaWYgKHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgZ2xvYmFsLkNhbGN1bGF0b3IgPSBDYWxjdWxhdG9yO1xufVxuZWxzZSB7XG4gICAgd2luZG93LkNhbGN1bGF0b3IgPSBDYWxjdWxhdG9yO1xufVxuIl0sIm5hbWVzIjpbIl9fd2VicGFja19yZXF1aXJlX18iLCJnIiwiZ2xvYmFsVGhpcyIsInRoaXMiLCJGdW5jdGlvbiIsImUiLCJ3aW5kb3ciLCJFdmFsdWF0b3IiLCJzdGF0aWMiLCJzZWNvbmQiLCJmaXJzdCIsIm9wZXJhdGlvbiIsIk1hdGgiLCJwb3ciLCJhdmFpbGFibGVPcGVyYXRvcnMiLCJDb252ZXJ0ZXIiLCJjb25zdHJ1Y3RvciIsImV4cHJlc3Npb24iLCJpbiIsIm91dCIsImdldE91dHB1dCIsImNvbnZlcnQiLCJGdW5Db252ZXJ0ZXIiLCJmdW5jIiwic3VwZXIiLCJleHBycyIsInJlZ2V4IiwiZnVuY3MiLCJ1bmRlZmluZWQiLCJwcmVwYXJlIiwiZXhwIiwiZXhlYyIsImdyb3VwcyIsImZ1biIsInB1c2giLCJpbnB1dCIsIm91dHB1dCIsInBhcmFtcyIsInNwbGl0IiwibWFwIiwiXyIsInBhcnNlRmxvYXQiLCJFcnJvciIsImkiLCJsZW5ndGgiLCJyZXBsYWNlIiwiTGluayIsImRhdGEiLCJuZXh0IiwicHJldmlvdXMiLCJkaXNwbGF5IiwiY29uc29sZSIsImxvZyIsIkxpc3QiLCJsZW4iLCJsYXN0IiwiZW50cnlQb2ludCIsImlzRW1wdHkiLCJpbnNlcnRGaXJzdCIsInRtcCIsImluc2VydExhc3QiLCJyZW1vdmVGaXJzdCIsInJlbW92ZUxhc3QiLCJnZXRGaXJzdCIsImdldExhc3QiLCJTdGFjayIsImxpc3QiLCJ2YWx1ZSIsInBvcCIsInBlZWsiLCJzaXplIiwiSGVscGVyIiwiaXNOYU4iLCJuZXh0VmFsdWUiLCJpc0RpZ2l0IiwiSVBvc3RDb252ZXJ0ZXIiLCJzdGFjayIsImNoYXIiLCJwb3NpdGlvbiIsImNoYXJBdCIsImlzTWl1bnMiLCJuZXdJcHV0Iiwic2xpY2UiLCJ0cmltIiwiaXNEb3QiLCJpc1NwYWNlIiwiaXNPcGVuQnJhY2tldCIsImlzQ2xvc2VkQnJhY2tldCIsImluZGV4T2YiLCJtYXRoT3BlcmF0b3JQcmlvcml0eSIsImV2YWx1YXRlIiwiY3VycmVudCIsIm1hdGhPcGVyYXRpb25zIiwidG9TdHJpbmciLCJDYWxjdWxhdG9yIiwiZnVjcyJdLCJzb3VyY2VSb290IjoiIn0=